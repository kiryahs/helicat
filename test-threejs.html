<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js Test</title>
    <style>
        body {
            margin: 0;
            background: #111;
            font-family: monospace;
            color: white;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border: 2px solid #0f0;
            z-index: 100;
        }
        #container {
            width: 500px;
            height: 500px;
            margin: 100px auto;
            border: 3px solid red;
            background: rgba(255,0,0,0.1);
        }
        canvas {
            border: 2px solid blue;
        }
    </style>
</head>
<body>
    <div id="info">
        <h2>Three.js Diagnostic Test</h2>
        <div id="status">Loading...</div>
        <div id="logs"></div>
    </div>

    <div id="container">
        <canvas id="testCanvas"></canvas>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        const log = (msg, color = '#0f0') => {
            console.log(msg);
            const logs = document.getElementById('logs');
            logs.innerHTML += `<div style="color: ${color}">${msg}</div>`;
        };

        const status = (msg) => {
            document.getElementById('status').textContent = msg;
        };

        try {
            status('Testing Three.js...');
            log('üîç Starting diagnostic...');

            if (typeof THREE === 'undefined') {
                throw new Error('THREE.js not loaded!');
            }
            log('‚úÖ THREE.js loaded: ' + THREE.REVISION);

            const canvas = document.getElementById('testCanvas');
            log('‚úÖ Canvas found: ' + canvas);

            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x222222);
            log('‚úÖ Scene created');

            const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);
            camera.position.set(0, 0, 7);
            camera.lookAt(0, 0, 0);
            log('‚úÖ Camera created at position (0, 0, 7)');

            const renderer = new THREE.WebGLRenderer({
                canvas: canvas,
                antialias: true
            });
            renderer.setSize(500, 500);
            log('‚úÖ Renderer created and sized to 500x500');

            // Add a rotating cube
            const geometry = new THREE.BoxGeometry(2, 2, 2);
            const material = new THREE.MeshPhongMaterial({
                color: 0xff6600,
                emissive: 0xff3300,
                emissiveIntensity: 0.5
            });
            const cube = new THREE.Mesh(geometry, material);
            scene.add(cube);
            log('‚úÖ Orange cube added to scene');

            // Add helicopter-style blades
            const bladeGeometry = new THREE.BoxGeometry(2.5, 0.4, 0.08);
            const bladeMaterial = new THREE.MeshPhongMaterial({
                color: 0xff9933,
                emissive: 0xff6600,
                emissiveIntensity: 0.4
            });

            const blade1 = new THREE.Mesh(bladeGeometry, bladeMaterial);
            blade1.position.x = 1.25;
            blade1.position.y = 2;
            scene.add(blade1);

            const blade2 = new THREE.Mesh(bladeGeometry, bladeMaterial);
            blade2.position.x = 1.25;
            blade2.position.y = 2;
            blade2.rotation.z = Math.PI / 2;
            scene.add(blade2);
            log('‚úÖ Helicopter blades added above cube');

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);
            log('‚úÖ Lights added');

            let frame = 0;
            const bladeGroup = new THREE.Group();
            bladeGroup.add(blade1);
            bladeGroup.add(blade2);
            bladeGroup.position.y = 2;
            scene.add(bladeGroup);
            scene.remove(blade1);
            scene.remove(blade2);

            function animate() {
                requestAnimationFrame(animate);

                frame++;
                if (frame % 60 === 0) {
                    log(`üé¨ Frame ${frame} rendering...`, '#ff0');
                }

                cube.rotation.x += 0.01;
                cube.rotation.y += 0.01;

                bladeGroup.rotation.z += 0.05;

                renderer.render(scene, camera);
            }

            log('üé¨ Starting animation...');
            status('‚úÖ All tests passed! You should see a rotating orange cube with spinning blades above it.');
            animate();

        } catch (error) {
            log('‚ùå ERROR: ' + error.message, '#f00');
            status('‚ùå Test failed: ' + error.message);
            console.error(error);
        }
    </script>
</body>
</html>
